---
import Layout from '~/layouts/PageLayout.astro';

const metadata = {
  title: 'ë¬¸ì˜í•˜ê¸°',
};
---

<Layout metadata={metadata}>
  <section class="max-w-3xl mx-auto py-16 px-4">
    <h1 class="text-3xl font-bold mb-6 text-center">ë¬¸ì˜í•˜ê¸°</h1>
    <form
      id="contactForm"
      action="https://formspree.io/f/xvgavpjy"
      method="POST"
      class="space-y-6 bg-white p-8 rounded-lg shadow-md"
    >
      <div>
        <label class="block text-sm font-medium text-gray-700">íšŒì‚¬ëª…</label>
        <input
          type="text"
          name="company"
          placeholder="-"
          class="mt-1 block w-full border border-gray-300 rounded px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
        />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">ë‹´ë‹¹ìëª…</label>
        <input
          type="text"
          name="manager"
          placeholder="-"
          class="mt-1 block w-full border border-gray-300 rounded px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
        />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">ì—°ë½ì²˜</label>
        <input
          type="tel"
          name="phone"
          placeholder="-"
          class="mt-1 block w-full border border-gray-300 rounded px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
        />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">ìˆ˜ì‹  ì´ë©”ì¼ / FAX</label>
        <input
          type="text"
          name="contact_method"
          placeholder="-"
          class="mt-1 block w-full border border-gray-300 rounded px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
        />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">ì„¤ì¹˜ ì£¼ì†Œ</label>
        <input
          type="text"
          name="address"
          placeholder="-"
          class="mt-1 block w-full border border-gray-300 rounded px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
        />
      </div>

      <div>
        <label class="block text-sm font-medium text-gray-700">ê¸°íƒ€ ìš”ì²­ ì‚¬í•­</label>
        <textarea
          name="message"
          rows="5"
          placeholder="-"
          class="mt-1 block w-full border border-gray-300 rounded px-3 py-2 focus:ring-blue-500 focus:border-blue-500"
        ></textarea>
      </div>

      <!-- ğŸ“Œ íŒŒì¼ ì—…ë¡œë“œëŠ” ë¬´ë£Œ í”Œëœ ë¯¸ì§€ì›ìœ¼ë¡œ ì œê±° -->

      <button
        type="submit"
        class="w-full bg-blue-600 text-white font-medium py-3 px-4 rounded hover:bg-blue-700 transition"
      >
        ë¬¸ì˜í•˜ê¸°
      </button>
    </form>
  </section>

  <!-- âœ… ìŠ¤í¬ë¦½íŠ¸ (íŒì—… ì•Œë¦¼ + ë¦¬ë‹¤ì´ë ‰íŠ¸ ì²˜ë¦¬) -->
  <script is:inline>
    const form = document.getElementById('contactForm');
    if (form) {
      form.addEventListener('submit', async (event) => {
        event.preventDefault();

        const inputs = form.querySelectorAll('input[type="text"], input[type="tel"], textarea');
        inputs.forEach((input) => {
          if (!input.value.trim()) {
            input.value = '-';
          }
        });

        try {
          const response = await fetch(form.action, {
            method: 'POST',
            body: new FormData(form),
            headers: { Accept: 'application/json' },
          });

          if (response.ok) {
            alert('ì „ì†¡ì— ì„±ê³µí•˜ì…¨ìŠµë‹ˆë‹¤.');
            window.location.href = '/'; // âœ… ë©”ì¸ í˜ì´ì§€ë¡œ ì´ë™
          } else {
            alert('ì „ì†¡ì— ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
          }
        } catch {
          alert('ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
        }
      });
    }
  </script>
</Layout>
